{
  "title": "Monitoring",
  "uid": "app-http-dashboard",
  "schemaVersion": 37,
  "version": 1,
  "refresh": "5s",
  "tags": [
    "prometheus",
    "http",
    "sqlite",
    "memory"
  ],
  "panels": [
    {
      "type": "timeseries",
      "title": "Total HTTP Requests Increase (Last 1 Minute)",
      "targets": [
        {
          "expr": "sum(rate(http_requests_total[1m]))",
          "legendFormat": "RPS",
          "refId": "A"
        }
      ],
      "gridPos": {
        "x": 0,
        "y": 8,
        "w": 24,
        "h": 8
      }
    },
    {
      "type": "timeseries",
      "title": "Heap Memory Used (Bytes)",
      "targets": [
        {
          "expr": "go_memstats_heap_alloc_bytes",
          "legendFormat": "heap_alloc",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "bytes",
          "color": {
            "mode": "palette-classic"
          }
        }
      },
      "gridPos": {
        "x": 0,
        "y": 14,
        "w": 12,
        "h": 8
      }
    },
    {
      "type": "timeseries",
      "title": "Memory Alloc vs Free Count",
      "targets": [
        {
          "expr": "rate(go_memstats_mallocs_total[1m])",
          "legendFormat": "Mallocs",
          "refId": "A"
        },
        {
          "expr": "rate(go_memstats_frees_total[1m])",
          "legendFormat": "Frees",
          "refId": "B"
        }
      ],
      "gridPos": {
        "x": 12,
        "y": 14,
        "w": 12,
        "h": 8
      }
    },
    {
      "type": "timeseries",
      "title": "CPU Usage (%)",
      "targets": [
        {
          "expr": "100 * (1 - avg by(instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[1m])))",
          "legendFormat": "{{instance}}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "percent",
          "color": {
            "mode": "palette-classic"
          }
        }
      },
      "gridPos": {
        "x": 0,
        "y": 24,
        "w": 12,
        "h": 8
      }
    },
    {
      "type": "stat",
      "title": "Active Targets",
      "targets": [
        {
          "expr": "count(up == 1)",
          "legendFormat": "Up",
          "refId": "A"
        }
      ],
      "gridPos": {
        "x": 12,
        "y": 22,
        "w": 12,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Users Count",
      "targets": [
        {
          "expr": "sqlite_users_count",
          "refId": "A"
        }
      ],
      "gridPos": {
        "x": 0,
        "y": 32,
        "w": 8,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Games Count",
      "targets": [
        {
          "expr": "sqlite_games_count",
          "refId": "A"
        }
      ],
      "gridPos": {
        "x": 8,
        "y": 32,
        "w": 8,
        "h": 4
      }
    },
    {
      "type": "stat",
      "title": "Tournaments Count",
      "targets": [
        {
          "expr": "sqlite_tournaments_count",
          "refId": "A"
        }
      ],
      "gridPos": {
        "x": 16,
        "y": 32,
        "w": 8,
        "h": 4
      }
    }
  ]
}
