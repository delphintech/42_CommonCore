<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Example</title>
	<style>
		.avatar {
			width: 100px;
			height: 100px;
			border-radius: 50%;
		}
		.container {
			display: flex;
			flex-direction: row;
			justify-content: center;
			align-items: center;
			height: 100%;
		}
		.title {
			text-align: center;
		}
		.btn-erasecookie {
			background-color: #ff0000;
			border: none;
			color: white;
			padding: 15px 32px;
			text-align: center;
			text-decoration: none;
			display: inline-block;
			font-size: 22px;
			margin: 4px 2px;
			cursor: pointer;
			border-radius: 5px;
			width: 100%;
		}

	</style>
</head>
<body>
	<h1 class="title" >Profile</h1>
	<div class="container">
		<div class="picture">
			<div id="avatar"></div>
		</div>
		<div class="info">
			<div id="name"></div>
			<div id="email"></div>
		</div>
	</div>

	<footer>
     	<button class="btn-erasecookie" onclick="eraseCookie()">Erase Cookie</button>		
	</footer>

    <script>
		function deleteCookie(name) {
			document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:01 GMT;SameSite=None;Secure; path=/';

        }

        function getCookie(name) {
            const nameEQ = name + "=";
            const ca = document.cookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }

        function eraseCookie() {
			deleteCookie('name');
			deleteCookie('email');
			deleteCookie('avatar');
			window.parent.postMessage({ action: "updated"}, "*");
 
        }
		const user = document.getElementById('name');
		const email = document.getElementById('email');
		const avatar = document.getElementById('avatar');
		let iscookie = false;
		if (getCookie('name')) {
			iscookie = true;
			user.innerHTML = `name : ${getCookie('name')}`;
		}
		if (getCookie('email')) {
			iscookie = true;
			email.innerHTML =  `email : ${decodeURIComponent(getCookie('email'))}`;
		}
		if (getCookie('avatar')) {
			iscookie = true;
			avatar.innerHTML = `<img class="avatar" src="/${getCookie('avatar')}" alt='Avatar'>`;
		}
		if (iscookie) {
			document.querySelector('.btn-erasecookie').style.display = 'block';
		}else{
			document.querySelector('.btn-erasecookie').style.display = 'none';
		}
    </script>
</body>
</html>